{#<!DOCTYPE html>#}
{#<html lang="ko">#}
{#<head>#}
{#    <meta charset="UTF-8">#}
{#    <meta name="viewport" content="width=device-width, initial-scale=1.0">#}
{#    <title>Flask Server - Unified Image Classification</title>#}
{##}
{#    <!-- âœ… CSS íŒŒì¼ ì—°ê²° -->#}
{#    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style.css') }}">#}
{##}
{#    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>#}
{#    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.1/socket.io.js"></script>#}
{#</head>#}
{#<body>#}
{##}
{#    <h1>Flask Server - Unified Image Classification</h1>#}
{#    <p>íŒ€ë³„ ëª¨ë¸ê³¼ YOLOv8ì„ ì‚¬ìš©í•˜ì—¬ ì´ë¯¸ì§€ ë¶„ë¥˜ ë° ê°ì²´ íƒì§€ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>#}
{##}
{#    <!-- ğŸ”¹ ê³µí†µ íŒŒì¼ ì—…ë¡œë“œ UI -->#}
{#    <div class="upload-section">#}
{#        <h3>Upload File</h3>#}
{#        <input type="file" id="fileInput">#}
{#        <button onclick="uploadFile()">Upload</button>#}
{#        <div id="loading" style="display: none; font-size: 20px; color: blue;">Processing your file... Please wait!</div>#}
{#        <div id="result"></div>#}
{#    </div>#}
{##}
{#    <!-- ğŸ”¹ ëª¨ë¸ ì„ íƒ UI -->#}
{#    <div class="upload-section">#}
{#        <h3>Select Model</h3>#}
{#        <button onclick="predict('team1')">Predict (Team1 - ë™ë¬¼)</button>#}
{#        <button onclick="predict('team2')">Predict (Team2 - ì¬í™œìš©)</button>#}
{#        <button onclick="predict('team3')">Predict (Team3 - ê³µêµ¬)</button>#}
{#        <button onclick="predict('yolo')">Predict (YOLOv8 - ê°ì²´ íƒì§€)</button>#}
{#    </div>#}
{##}
{#    <!-- ğŸ”¹ ì—…ë¡œë“œëœ íŒŒì¼ ë¯¸ë¦¬ë³´ê¸° -->#}
{#    <div class="preview-container">#}
{#        <img id="preview-image" src="" style="display: none; max-width: 300px; margin-top: 10px; border: 1px solid #ddd;">#}
{#    </div>#}
{##}
{#    <script>#}
{#        const socket = io(); // WebSocket ì—°ê²°#}
{#        let uploadedFile = null; // ì—…ë¡œë“œëœ íŒŒì¼ ì €ì¥#}
{##}
{#        // ğŸ”¹ íŒŒì¼ ì—…ë¡œë“œ (ê³µí†µ)#}
{#        function uploadFile() {#}
{#            const fileInput = document.getElementById("fileInput");#}
{#            if (fileInput.files.length === 0) {#}
{#                alert("íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”.");#}
{#                return;#}
{#            }#}
{##}
{#            const formData = new FormData();#}
{#            formData.append("file", fileInput.files[0]);#}
{#            uploadedFile = fileInput.files[0]; // ì €ì¥#}
{##}
{#            // ë¡œë”© í‘œì‹œ#}
{#            showLoading(true);#}
{#            document.getElementById("result").innerHTML = "";#}
{##}
{#            fetch('/upload', {#}
{#                method: 'POST',#}
{#                body: formData,#}
{#            })#}
{#            .then(response => response.json())#}
{#            .then(data => {#}
{#                if (data.error) {#}
{#                    alert(data.error);#}
{#                    showLoading(false);#}
{#                }#}
{#            })#}
{#            .catch(error => {#}
{#                console.error("Upload error:", error);#}
{#                showLoading(false);#}
{#            });#}
{##}
{#            // ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ê¸°ëŠ¥ ì¶”ê°€#}
{#            previewImage(fileInput.files[0]);#}
{#        }#}
{##}
{#        // ğŸ”¹ ëª¨ë¸ ì˜ˆì¸¡ ìš”ì²­ (YOLOv8 = WebSocket, íŒ€ ëª¨ë¸ = AJAX)#}
{#        function predict(modelType) {#}
{#            if (!uploadedFile) {#}
{#                alert("ë¨¼ì € íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”.");#}
{#                return;#}
{#            }#}
{##}
{#            const formData = new FormData();#}
{#            formData.append("image", uploadedFile);#}
{##}
{#            if (modelType === "yolo") {#}
{#                // YOLOv8ì€ WebSocketì„ ì‚¬ìš©í•˜ì—¬ ê²°ê³¼ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ìˆ˜ì‹ #}
{#                showLoading(true);#}
{#                document.getElementById("result").innerHTML = "";#}
{#            } else {#}
{#                // íŒ€ë³„ ëª¨ë¸ì€ AJAX ìš”ì²­#}
{#                fetch(`/predict/${modelType}`, {#}
{#                    method: 'POST',#}
{#                    body: formData,#}
{#                })#}
{#                .then(response => response.json())#}
{#                .then(data => displayResult(data))#}
{#                .catch(error => {#}
{#                    console.error("Prediction error:", error);#}
{#                    document.getElementById("result").innerHTML = "<p style='color:red;'>ì˜ˆì¸¡ ì‹¤íŒ¨</p>";#}
{#                });#}
{#            }#}
{#        }#}
{##}
{#        // ğŸ”¹ YOLOv8 ê²°ê³¼ ìˆ˜ì‹  (WebSocket)#}
{#        socket.on("file_processed", (data) => {#}
{#            showLoading(false);#}
{#            displayResult({ url: data.url });#}
{#        });#}
{##}
{#        // ğŸ”¹ [ê³µí†µ í•¨ìˆ˜] ë¡œë”© ìƒíƒœ í‘œì‹œ#}
{#        function showLoading(isLoading) {#}
{#            document.getElementById("loading").style.display = isLoading ? "block" : "none";#}
{#        }#}
{##}
{#        // ğŸ”¹ [ê³µí†µ í•¨ìˆ˜] ì—…ë¡œë“œí•œ íŒŒì¼ ë¯¸ë¦¬ë³´ê¸°#}
{#        function previewImage(file) {#}
{#            const reader = new FileReader();#}
{#            reader.onload = function (e) {#}
{#                const preview = document.getElementById("preview-image");#}
{#                preview.src = e.target.result;#}
{#                preview.style.display = "block";#}
{#            };#}
{#            reader.readAsDataURL(file);#}
{#        }#}
{##}
{#        // ğŸ”¹ [ê³µí†µ í•¨ìˆ˜] ê²°ê³¼ í‘œì‹œ#}
{#        function displayResult(data) {#}
{#            const resultContainer = document.getElementById("result");#}
{#            if (!data.url) {#}
{#                resultContainer.innerHTML = "<p style='color: red;'>ì²˜ë¦¬ëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.</p>";#}
{#                return;#}
{#            }#}
{##}
{#            resultContainer.innerHTML = `#}
{#                <h2>Processed File</h2>#}
{#                ${data.url.endsWith(".mp4")#}
{#                    ? `<video controls width="640"><source src="${data.url}" type="video/mp4">Your browser does not support the video tag.</video>`#}
{#                    : `<img src="${data.url}" alt="Processed Image" style="max-width: 100%; height: auto;">`#}
{#                }#}
{#            `;#}
{#        }#}
{#    </script>#}
{##}
{#</body>#}
{#</html>#}
